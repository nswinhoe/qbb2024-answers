---
title: "2024_09_03"
output: html_document
date: "2024-09-03"
---

Day1 Morning:
```{r}
#load tidyverse
library(tidyverse)

#Load the GTEx_Analysis_v8_Annotations_SampleAttributesDS.txt file 
read_tsv("/data/learn/qb24/GTEx/GTEx_Analysis_v8_Annotations_SampleAttributesDS.txt")

#assign to variable df
df = read_tsv("/data/learn/qb24/GTEx/GTEx_Analysis_v8_Annotations_SampleAttributesDS.txt")
```


```{r}
#Create a SUBJECT column using the following code
 df <- df %>%
    mutate( SUBJECT=str_extract( SAMPID, "[^-]+-[^-]+" ), .before=1 )

#Confirm that the first column in df is SUBJECT
head(df)
```


```{r}
#Which two SUBJECTs have the most samples? The least?
#Use group_by(), summarize(), and arrange()

#the most
df %>%
  group_by(SUBJECT) %>%
  summarize(n())  %>%
  arrange(`n()`)

#the least
df %>%
  group_by(SUBJECT) %>%
  summarize(n())  %>%
  arrange(desc(`n()`))
  
```


```{r}
#Which two SMTSDs (tissue types) have the most samples? The least? Why?

#the most
df %>%
  group_by(SMTSD) %>%
  summarize(n()) %>%
  arrange(desc(`n()`))

#the least
df %>%
  group_by(SMTSD) %>%
  summarize(n()) %>%
  arrange(`n()`)
```


```{r}
#For subject GTEX-NPJ8
#Filter for samples from this subject and save as a new object (e.g. df_npj8)

df_npj8 <- filter(df, SUBJECT == "GTEX-NPJ8")

df_npj8 %>%
  group_by(SMTSD) %>%
  summarize(n()) %>%
  arrange(desc(`n()`))
  
```



```{r}
#Explore SMATSSCR (autolysis score)

#Filter out NA values in this column to avoid mean() returning NA
#How many SUBJECTs have a mean SMATSSCR score of 0

df %>%
  group_by(SMATSSCR) %>%
  filter(!is.na(SMATSSCR)) %>%
  summarize (n()) %>%
  arrange(`n()`)
```


Day1 Afternoon:

Penguin data
```{r}
#library(tidyverse)
#install.packages('palmerpenguins')
#install.packages('ggthemes')
#library(ggthemes)
#library(palmerpenguins)

glimpse(penguins)
penguins
?penguins

#indexing the data, rows first them columns
#extract island column = all rows, island column
penguins[ , "island"]

#extract species and island
penguins[ , c("species", "island")]

#look at second observation
penguins[ 2 , c("species", "island")]

#same thing but with numbers
penguins[ 2 , 2]

```

Penguin data
```{r}
#library(palmerpenguins)
#library(ggplot2)


ggplot(data = penguins) +
  geom_point(mapping = aes(x = flipper_length_mm, 
                     y = body_mass_g, 
                     color = species,
                     shape = species)) +
  scale_color_colorblind() +
  #scale_color_manual(values = c("orange", "lightblue", "pink")) +
  geom_smooth(mapping = aes(x = flipper_length_mm, 
                     y = body_mass_g), method = "lm") +
  xlab("Flipper length (mm)") +
  ylab("Body mass (g)") +
  ggtitle("Relationship between body mass and flipper length \nin Antarctic Penguins")

#ggsave(filename = "~/qbb24-answers/d1-afternoon/penguin-plot.pdf")

```

Panguin data
```{r}
#does bill length depend on sex of penguin
#distribution of a continuous variable

#ggplot(data = penguins %>% filter(sex == "male"), mapping = aes( x = bill_length_mm))+
#  geom_histogram()

# to plot side by side facet_grid(. ~ sex)

ggplot(data = penguins, 
       mapping = aes( x = bill_length_mm, fill = sex))+
  scale_fill_colorblind() +
  geom_histogram(position = "identity", alpha = 0.5)


ggplot(data = penguins %>% filter(!is.na(sex)),
       mapping = aes( x = bill_length_mm, fill = sex))+
  scale_fill_colorblind() +
  geom_histogram(position = "identity", alpha = 0.5) +
  facet_grid(sex ~ species)

#body mass over time
ggplot( data= penguins, mapping = aes(x = factor(year), 
                                      y = body_mass_g, 
                                      fill = sex)) +
  scale_fill_colorblind() +
  geom_boxplot() +
  facet_grid(island ~ species)
```


Afternoon assignment: 

```{r}
#Load tidyverse, use read_delim() to read in sample-level metadata that was obtained from the GTEx Portal
#GTEx_Analysis_v8_Annotations_SampleAttributesDS.txt

setwd("/home/nswinhoe/R/2024_qbb24_bootcamp")



```









